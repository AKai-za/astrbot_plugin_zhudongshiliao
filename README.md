# 自动私聊插件 (astrbot_plugin_zhudongshiliao)

## 插件简介

自动私聊插件是一个为 AstrBot 设计的智能插件，当大模型识别到需要时触发私聊功能。插件采用工具模式，由大模型自己判断何时调用，支持告状功能和自定义报错处理。

## 功能特性

- **智能私聊**：当大模型识别到用户需要私聊时，自动发送私聊消息
- **告状功能**：当bot被辱骂时，会自动向管理员发送告状消息
- **自定义报错**：支持自定义错误信息格式，详细的错误信息会发送给管理员
- **实时配置**：支持通过WebUI动态修改配置，无需重启插件
- **简洁高效**：代码结构简洁，功能专注，不干扰正常对话

## 安装方法

1. 克隆或下载本插件到 AstrBot 的插件目录：
   ```
   d:\Astrbot\AstrBot\data\plugins\
   ```

2. 确保插件目录结构如下：
   ```
   astrbot_plugin_zhudongshiliao/
   ├── main.py          # 插件主文件
   ├── _conf_schema.json  # WebUI配置文件
   ├── metadata.yaml    # 插件元数据
   ├── config.json      # 配置文件（自动生成）
   └── README.md        # 本说明文件
   ```

3. 重启 AstrBot，插件会自动加载

## 配置说明

插件支持通过 WebUI 进行配置，主要配置项包括：

| 配置项 | 类型 | 默认值 | 说明 |
|-------|------|-------|------|
| admin_list | 列表 | ["2757808353"] | 管理员ID列表，用于接收错误信息和告状消息 |
| enable_private_chat | 布尔值 | true | 是否启用私聊功能 |
| enable_sue | 布尔值 | true | 是否启用告状功能 |
| error_format | 字符串 | "【错误信息】\n方法: {method}\n错误: {error}" | 错误信息格式，支持 {method} 和 {error} 占位符 |

## 使用方法

### 触发私聊

当用户在群聊中提到需要私聊时，大模型会识别并触发私聊功能。例如：
- "能私聊一下吗？"
- "私聊我"
- "我们私聊说"

### 触发告状

当用户在群聊中辱骂或欺负bot时，大模型会识别并触发告状功能，向管理员发送私聊消息。

### 错误处理

当插件发生错误时，会自动向管理员发送详细的错误信息，便于排查问题。

## 工作原理

1. **消息接收**：插件接收所有消息事件
2. **意图分析**：调用大模型分析消息意图
3. **智能处理**：根据意图执行相应操作（私聊、告状或忽略）
4. **事件管理**：只在必要时阻止事件传播

## 版本历史

### v0.0.2 (2026-02-15)
- 简化代码结构，移除冗余的异常处理和日志输出
- 优化告状功能，让大模型自己生成告状内容
- 更新README.md，添加详细的使用说明

### v0.0.1 (2026-02-15)
- 初始版本
- 实现大模型判断意图的工具模式
- 实现私聊功能和告状功能
- 实现自定义报错处理

## 注意事项

1. 插件依赖于 AstrBot 的大模型能力，确保 AstrBot 已正确配置聊天模型
2. 插件采用工具模式，由大模型自己判断何时调用，不会干扰正常对话
3. 建议将重要的管理员ID添加到配置中，以便接收错误信息和告状消息
4. 如遇到问题，请查看 AstrBot 的日志文件获取详细信息

## 联系方式

- 作者：引灯续昼
- 仓库：https://github.com/HLC2757808353/astrbot_plugin_zhudongshiliao

如有问题或建议，欢迎提交 issue 或 pull request。
