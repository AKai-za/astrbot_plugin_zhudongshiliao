# 自动私聊插件 (astrbot_plugin_zhudongshiliao)

## 插件简介

自动私聊插件是一个为 AstrBot 设计的工具插件，提供私聊功能作为工具供大模型调用。插件采用工具模式，由大模型自己判断何时调用，确保人格一致性。

## 功能特性

- **工具模式**：作为工具供大模型调用，确保人格一致性
- **私聊功能**：提供发送私聊消息的工具
- **管理员消息**：提供发送消息给管理员的工具
- **实时配置**：支持通过WebUI动态修改配置
- **简洁高效**：代码结构简洁，功能专注

## 安装方法

1. 克隆或下载本插件到 AstrBot 的插件目录：
   ```
   d:\Astrbot\AstrBot\data\plugins\
   ```

2. 确保插件目录结构如下：
   ```
   astrbot_plugin_zhudongshiliao/
   ├── main.py          # 插件主文件
   ├── _conf_schema.json  # WebUI配置文件
   ├── metadata.yaml    # 插件元数据
   ├── config.json      # 配置文件（自动生成）
   └── README.md        # 本说明文件
   ```

3. 重启 AstrBot，插件会自动加载并注册工具

## 配置说明

插件支持通过 WebUI 进行配置，主要配置项包括：

| 配置项 | 类型 | 默认值 | 说明 |
|-------|------|-------|------|
| admin_list | 列表 | ["2757808353"] | 管理员ID列表，用于接收通过工具发送的消息 |

## 工具使用

插件注册了以下工具供大模型调用：

### send_private_message

发送私聊消息给指定用户。

**参数**：
- `user_id` (string)：用户ID，QQ号
- `message` (string)：私聊消息内容

**返回值**：
- 成功："私聊消息发送成功"
- 失败："私聊消息发送失败" 或错误信息

### send_admin_message

发送消息给所有管理员。

**参数**：
- `message` (string)：发送给管理员的消息内容

**返回值**：
- 成功："成功发送消息给 X 个管理员"
- 失败："发送消息给管理员失败" 或错误信息

## 工作原理

1. **插件加载**：插件启动时注册两个工具
2. **大模型调用**：大模型根据对话内容判断是否需要使用私聊工具
3. **工具执行**：工具执行相应的私聊操作
4. **结果返回**：工具返回执行结果给大模型
5. **大模型回复**：大模型根据工具执行结果生成回复

## 版本历史

### v0.0.3 (2026-02-15)
- 完全重写为工具模式，让大模型调用插件
- 移除所有大模型调用逻辑，确保人格一致性
- 注册两个工具：send_private_message 和 send_admin_message
- 简化配置和代码结构

### v0.0.2 (2026-02-15)
- 简化代码结构，移除冗余的异常处理和日志输出
- 优化告状功能，让大模型自己生成告状内容
- 更新README.md，添加详细的使用说明

### v0.0.1 (2026-02-15)
- 初始版本
- 实现大模型判断意图的工具模式
- 实现私聊功能和告状功能
- 实现自定义报错处理

## 注意事项

1. 插件作为工具供大模型调用，不会主动处理消息
2. 大模型会根据对话内容判断是否需要使用私聊工具
3. 建议将重要的管理员ID添加到配置中，以便接收消息
4. 如遇到问题，请查看 AstrBot 的日志文件获取详细信息

## 联系方式

- 作者：引灯续昼
- 仓库：https://github.com/HLC2757808353/astrbot_plugin_zhudongshiliao

如有问题或建议，欢迎提交 issue 或 pull request。
